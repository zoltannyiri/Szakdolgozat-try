<div class="min-h-screen bg-gradient-to-br from-[#0f172a] to-[#1e293b] text-slate-100">
  <div class="mx-auto max-w-6xl px-4 py-8">

    <!-- HEADER -->
    <section class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 backdrop-blur-sm shadow-xl">
      <div class="p-6">
        <div class="grid grid-cols-12 gap-6">
          <!-- LEFT: NAME + META -->
          <div class="col-span-12 md:col-span-8">
            <div class="flex items-center gap-3">
              <h1 class="text-3xl font-bold tracking-tight bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">
                {{ userData?.username || '—' }}
              </h1>

              <!-- verified badge -->
              <span *ngIf="userData?.isVerified"
                    class="inline-flex items-center gap-1 rounded-full border border-emerald-400/40 bg-gradient-to-r from-emerald-500/20 to-green-500/20 px-2.5 py-1 text-xs font-medium text-emerald-300 shadow-sm">
                <i class="bi bi-patch-check-fill"></i> Verified
              </span>
            </div>

            <div class="mt-3 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-slate-300">
              <span class="inline-flex items-center gap-2 rounded-lg bg-slate-700/40 px-3 py-1.5 backdrop-blur-sm">
                <i class="bi bi-geo-alt text-amber-400"></i>
                {{ userData?.city || '—' }}, {{ userData?.country || '—' }}
              </span>

              <span class="inline-flex items-center gap-2 rounded-lg bg-slate-700/40 px-3 py-1.5 backdrop-blur-sm">
                <i class="bi bi-calendar-event text-orange-400"></i>
                Joined : {{ userData?.date | date:'d MMM yyyy' }}
              </span>

              <span class="inline-flex items-center gap-2 rounded-lg bg-slate-700/40 px-3 py-1.5 backdrop-blur-sm">
                <i class="bi bi-activity"
                   [ngClass]="{ 'text-emerald-400': isActive, 'text-amber-400': !isActive }"></i>
                Last Online : {{ userData?.lastLogin | date:'d MMM yyyy, HH:mm' }}
              </span>
            </div>
          </div>

          <!-- RIGHT: AVATAR -->
          <div class="col-span-12 md:col-span-4 md:justify-self-end">
            <div class="relative inline-block">
              <div class="h-32 w-32 overflow-hidden rounded-full ring-4 ring-slate-800 shadow-xl">
                <div class="absolute inset-0 rounded-full ring-[3px] ring-amber-400/60 animate-pulse"></div>
                <ng-container *ngIf="userData?.profileImage; else initials">
                  <img [src]="'http://localhost:3000' + userData.profileImage"
                       alt="Profilkép" class="h-full w-full object-cover transition-transform duration-500 hover:scale-110" />
                </ng-container>
                <ng-template #initials>
                  <div class="grid h-full w-full place-items-center bg-gradient-to-br from-amber-600 to-orange-600 text-4xl font-black">
                    {{ getInitials(userData?.username || '') }}
                  </div>
                </ng-template>
              </div>

              <!-- Edit button -->
              <label *ngIf="isCurrentUser" for="avatarUpload"
                     class="absolute -bottom-2 right-0 cursor-pointer rounded-full border border-white/20 bg-gradient-to-r from-slate-700 to-slate-800 px-3 py-1 text-xs font-medium backdrop-blur transition-all hover:from-amber-600 hover:to-orange-600">
                <i class="bi bi-camera-fill mr-1"></i> Edit
              </label>
              <input id="avatarUpload" type="file" accept="image/*" class="hidden" (change)="onAvatarSelected($event)" />
            </div>
            
            <!-- AVATAR alatti beállítás gomb -->
            <div class="mt-3 flex justify-end" *ngIf="isCurrentUser">
              <button (click)="openSettings()"
                      class="inline-flex items-center gap-2 rounded-lg bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600 px-4 py-2 text-sm font-medium transition-all hover:from-amber-600 hover:to-orange-600 hover:shadow-lg">
                <i class="bi bi-sliders"></i>
                Settings
              </button>
            </div>

          </div>
        </div>
      </div>

      <!-- MAIN TABS -->
      <div class="border-t border-slate-600/30 px-4">
        <nav class="flex gap-6 overflow-x-auto">
          <button class="py-4 text-sm font-medium border-b-2 transition-all duration-200"
                  [class.text-amber-400]="activeMainTab==='profile'"
                  [class.border-amber-400]="activeMainTab==='profile'"
                  [class.text-slate-400]="activeMainTab!=='profile'"
                  [class.border-transparent]="activeMainTab!=='profile'"
                  [class.hover:text-amber-300]="activeMainTab!=='profile'"
                  (click)="activeMainTab='profile'">
            <i class="bi bi-person-circle mr-2"></i>Profile
          </button>
          <button class="py-4 text-sm font-medium border-b-2 transition-all duration-200"
                  [class.text-amber-400]="activeMainTab==='loops'"
                  [class.border-amber-400]="activeMainTab==='loops'"
                  [class.text-slate-400]="activeMainTab!=='loops'"
                  [class.border-transparent]="activeMainTab!=='loops'"
                  [class.hover:text-amber-300]="activeMainTab!=='loops'"
                  (click)="activeMainTab='loops'">
            <i class="bi bi-music-note-beamed mr-2"></i>Loops
          </button>
          <button class="py-4 text-sm font-medium border-b-2 transition-all duration-200"
                  [class.text-amber-400]="activeMainTab==='acapellas'"
                  [class.border-amber-400]="activeMainTab==='acapellas'"
                  [class.text-slate-400]="activeMainTab!=='acapellas'"
                  [class.border-transparent]="activeMainTab!=='acapellas'"
                  [class.hover:text-amber-300]="activeMainTab!=='acapellas'"
                  (click)="activeMainTab='acapellas'">
            <i class="bi bi-mic-fill mr-2"></i>Acapellas
          </button>
          <button class="py-4 text-sm font-medium border-b-2 transition-all duration-200"
                  [class.text-amber-400]="activeMainTab==='tracks'"
                  [class.border-amber-400]="activeMainTab==='tracks'"
                  [class.text-slate-400]="activeMainTab!=='tracks'"
                  [class.border-transparent]="activeMainTab!=='tracks'"
                  [class.hover:text-amber-300]="activeMainTab!=='tracks'"
                  (click)="activeMainTab='tracks'">
            <i class="bi bi-file-earmark-music-fill mr-2"></i>Tracks
          </button>
          <button class="py-4 text-sm font-medium border-b-2 transition-all duration-200"
                  [class.text-amber-400]="activeMainTab==='comments'"
                  [class.border-amber-400]="activeMainTab==='comments'"
                  [class.text-slate-400]="activeMainTab!=='comments'"
                  [class.border-transparent]="activeMainTab!=='comments'"
                  [class.hover:text-amber-300]="activeMainTab!=='comments'"
                  (click)="activeMainTab='comments'">
            <i class="bi bi-chat-dots-fill mr-2"></i>Comments
          </button>
        </nav>
      </div>
    </section>

    <!-- BODY -->
    <section class="mt-6 grid grid-cols-1 gap-6 lg:grid-cols-3">

      <!-- LEFT: PROFILE CONTENT -->
      <div class="lg:col-span-2 space-y-6">

        <!-- SUB TABS (About / Blocked / Ignored / Followed) -->
        <div *ngIf="activeMainTab==='profile'" class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 backdrop-blur-sm shadow-xl">
          <div class="flex items-center justify-between border-b border-slate-600/30 px-4 py-3">
            <div class="flex gap-2 text-[13px]">
              <button class="rounded-lg px-3 py-1.5 font-medium transition-all duration-200"
                      [class.bg-slate-700]="profileSub==='about'"
                      [class.text-amber-400]="profileSub==='about'"
                      [class.text-slate-300]="profileSub!=='about'"
                      [class.hover:text-amber-300]="profileSub!=='about'"
                      (click)="profileSub='about'">
                <i class="bi bi-info-circle mr-1"></i>About Me
              </button>
              <button class="rounded-lg px-3 py-1.5 font-medium transition-all duration-200"
                      [class.bg-slate-700]="profileSub==='blocked'"
                      [class.text-amber-400]="profileSub==='blocked'"
                      [class.text-slate-300]="profileSub!=='blocked'"
                      [class.hover:text-amber-300]="profileSub!=='blocked'"
                      (click)="profileSub='blocked'">
                <i class="bi bi-slash-circle mr-1"></i>Blocked
              </button>
              <button class="rounded-lg px-3 py-1.5 font-medium transition-all duration-200"
                      [class.bg-slate-700]="profileSub==='ignored'"
                      [class.text-amber-400]="profileSub==='ignored'"
                      [class.text-slate-300]="profileSub!=='ignored'"
                      [class.hover:text-amber-300]="profileSub!=='ignored'"
                      (click)="profileSub='ignored'">
                <i class="bi bi-eye-slash mr-1"></i>Ignored
              </button>
              <button class="rounded-lg px-3 py-1.5 font-medium transition-all duration-200"
                      [class.bg-slate-700]="profileSub==='followed'"
                      [class.text-amber-400]="profileSub==='followed'"
                      [class.text-slate-300]="profileSub!=='followed'"
                      [class.hover:text-amber-300]="profileSub!=='followed'"
                      (click)="profileSub='followed'">
                <i class="bi bi-people-fill mr-1"></i>Followed
              </button>
            </div>

            <button *ngIf="isCurrentUser && profileSub==='about' && !isEditing"
                    (click)="startEditing()"
                    class="rounded-lg bg-gradient-to-r from-amber-600 to-orange-600 px-3 py-1.5 text-sm font-medium hover:from-amber-500 hover:to-orange-500 transition-all">
              <i class="bi bi-pencil-square mr-1"></i>Edit
            </button>
          </div>

          <!-- About Me panel -->
          <div *ngIf="profileSub==='about'" class="p-4">
            <h3 class="mb-2 text-lg font-semibold text-amber-400">About Me</h3>

            <div *ngIf="!isEditing; else aboutEdit"
                 class="whitespace-pre-wrap text-sm text-slate-300 min-h-[4rem] bg-slate-700/40 rounded-lg p-4 backdrop-blur-sm">
              {{ aboutMe || 'No information provided yet.' }}
            </div>

            <ng-template #aboutEdit>
              <textarea [(ngModel)]="aboutMe" rows="6"
                        class="w-full rounded-lg border border-slate-600 bg-slate-700/50 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-amber-400/40 backdrop-blur-sm"></textarea>
              <div class="mt-3 flex gap-2">
                <button (click)="saveGeneral()" [disabled]="saving.general"
                        class="rounded-lg bg-gradient-to-r from-emerald-600 to-green-600 px-4 py-2 text-sm font-medium hover:from-emerald-500 hover:to-green-500 transition-all disabled:opacity-60">
                  {{ saving.general ? 'Saving…' : 'Save Changes' }}
                </button>
                <button (click)="cancelEditing()" [disabled]="saving.general"
                        class="rounded-lg border border-slate-600 bg-slate-700/50 px-4 py-2 text-sm font-medium hover:bg-slate-600/50 transition-all disabled:opacity-60">
                  Cancel
                </button>
              </div>
              <p *ngIf="msg.general" class="mt-2 text-sm text-emerald-300">{{ msg.general }}</p>
              <p *ngIf="err.general" class="mt-2 text-sm text-rose-300">{{ err.general }}</p>
            </ng-template>
          </div>

          <!-- Blocked / Ignored / Followed helykitöltők -->
          <div *ngIf="profileSub!=='about'" class="p-6 text-center">
            <div class="text-slate-400 mb-2 text-4xl">
              <i *ngIf="profileSub==='blocked'" class="bi bi-slash-circle"></i>
              <i *ngIf="profileSub==='ignored'" class="bi bi-eye-slash"></i>
              <i *ngIf="profileSub==='followed'" class="bi bi-people"></i>
            </div>
            <p class="text-sm text-slate-300">
              <span *ngIf="profileSub==='blocked'">No blocked users.</span>
              <span *ngIf="profileSub==='ignored'">No ignored users.</span>
              <span *ngIf="profileSub==='followed'">No followed users.</span>
            </p>
          </div>
        </div>

        <!-- MY NETWORKS -->
        <div *ngIf="activeMainTab==='profile'" class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-5 shadow-xl backdrop-blur-sm">
          <h3 class="text-lg font-semibold mb-2 text-amber-400">My Networks</h3>

          <div class="flex flex-wrap gap-2 mb-4" *ngIf="userData?.socials">
            <a *ngIf="userData.socials.facebook"   [href]="userData.socials.facebook"   target="_blank" rel="noopener"
              class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-facebook"></i> Facebook
            </a>
            <a *ngIf="userData.socials.instagram"  [href]="userData.socials.instagram"  target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-instagram"></i> Instagram
            </a>
            <a *ngIf="userData.socials.youtube"    [href]="userData.socials.youtube"    target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-youtube"></i> YouTube
            </a>
            <a *ngIf="userData.socials.soundcloud" [href]="userData.socials.soundcloud" target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-soundwave"></i> SoundCloud
            </a>
            <a *ngIf="userData.socials.spotify"    [href]="userData.socials.spotify"    target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-spotify"></i> Spotify
            </a>
            <a *ngIf="userData.socials.tiktok"     [href]="userData.socials.tiktok"     target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-tiktok"></i> TikTok
            </a>
            <a *ngIf="userData.socials.x"          [href]="userData.socials.x"          target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-twitter-x"></i> X
            </a>
            <a *ngIf="userData.socials.website"    [href]="userData.socials.website"    target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-globe"></i> Website
            </a>
            <a *ngIf="userData.socials.email"      [href]="userData.socials.email"      target="_blank" rel="noopener" class="inline-flex items-center gap-2 rounded-lg bg-slate-700/50 px-3 py-1.5 text-sm hover:bg-slate-700/70">
              <i class="bi bi-envelope"></i> Email
            </a>
          </div>

          <button *ngIf="isCurrentUser"
                  class="rounded-lg bg-gradient-to-r from-amber-600 to-orange-600 px-4 py-2 text-sm font-medium hover:from-amber-500 hover:to-orange-500 transition-all"
                  (click)="openSettings()">
            <i class="bi bi-plus-circle mr-1"></i> Add your network links
          </button>
        </div>


        <!-- LOOPS TAB -->
        <div *ngIf="activeMainTab==='loops'"
             class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-6 shadow-xl backdrop-blur-sm">

          <!-- Header with stats and upload button -->
          <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
            <div>
              <h3 class="text-xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ userData?.username }}'s Loops</h3>
              <p class="text-sm text-slate-300 mt-1">Collection of audio loops</p>
            </div>

            <div class="flex items-center gap-3">
              <div class="hidden sm:flex items-center gap-4 text-sm text-slate-300">
                <span class="flex items-center gap-1">
                  <i class="bi bi-music-note-beamed text-amber-400"></i>
                  <span class="font-semibold">{{ userLoops.length }}</span> loops
                </span>
                <span class="flex items-center gap-1">
                  <i class="bi bi-download text-orange-400"></i>
                  <span class="font-semibold">{{ totalDownloads() }}</span> downloads
                </span>
                <span class="flex items-center gap-1">
                  <i class="bi bi-heart text-rose-400"></i>
                  <span class="font-semibold">{{ totalLikes() }}</span> likes
                </span>
              </div>

              <button *ngIf="isCurrentUser"
                      class="flex items-center gap-2 rounded-lg bg-gradient-to-r from-amber-600 to-orange-600 px-4 py-2 text-sm font-medium hover:from-amber-500 hover:to-orange-500 transition-all"
                      (click)="uploadNewLoop()">
                <i class="bi bi-plus-lg"></i>
                Upload Loop
              </button>
            </div>
          </div>

          <!-- Loading -->
          <div *ngIf="loopsLoading" class="flex flex-col items-center justify-center py-12 text-slate-400">
            <i class="bi bi-arrow-repeat animate-spin text-4xl mb-3"></i>
            <p>Loading your loops...</p>
          </div>

          <!-- Empty -->
          <div *ngIf="!loopsLoading && userLoops.length === 0"
               class="flex flex-col items-center justify-center py-12 text-center">
            <div class="w-20 h-20 rounded-full bg-slate-700/40 flex items-center justify-center mb-4 backdrop-blur-sm">
              <i class="bi bi-music-note-beamed text-4xl text-slate-400"></i>
            </div>
            <h4 class="text-lg font-semibold text-slate-200 mb-2">No loops yet</h4>
            <p class="text-sm text-slate-300 max-w-md mb-6">Start building your collection by uploading your first loop</p>
            <button *ngIf="isCurrentUser"
                    class="rounded-lg bg-gradient-to-r from-amber-600 to-orange-600 px-5 py-2.5 font-medium hover:from-amber-500 hover:to-orange-500 transition-all"
                    (click)="uploadNewLoop()">
              <i class="bi bi-cloud-upload mr-2"></i>Upload First Loop
            </button>
          </div>

          <!-- Grid -->
          <div *ngIf="!loopsLoading && userLoops.length" class="space-y-4">
            <!-- Filters -->
            <div class="flex flex-col sm:flex-row gap-3 justify-between items-start sm:items-center p-3 bg-slate-700/40 rounded-lg backdrop-blur-sm">
              <div class="flex items-center gap-2 text-sm text-slate-300">
                <i class="bi bi-funnel text-amber-400"></i>
                <span>Filter:</span>
                <select class="bg-slate-700/50 border border-slate-600 rounded-md px-2 py-1 text-slate-200 text-sm focus:outline-none focus:ring-1 focus:ring-amber-400/30">
                  <option>All loops</option>
                  <option>Most popular</option>
                  <option>Recent</option>
                </select>
              </div>

              <div class="relative">
                <i class="bi bi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i>
                <input type="text" placeholder="Search loops..."
                       class="pl-9 pr-3 py-1.5 bg-slate-700/50 border border-slate-600 rounded-md text-sm text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-amber-400/30">
              </div>
            </div>

            <!-- Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div *ngFor="let loop of userLoops"
                   class="group relative rounded-xl border border-slate-600/30 bg-gradient-to-b from-slate-700/40 to-slate-800/40 p-4 hover:bg-slate-700/60 transition-all duration-300 backdrop-blur-sm">

                <!-- Visual -->
                <div class="relative mb-4 h-32 rounded-lg bg-gradient-to-br from-amber-900/20 to-orange-900/20 overflow-hidden backdrop-blur-sm">
                  <div class="absolute inset-0 flex items-end justify-center space-x-[1px] pb-3">
                    <div *ngFor="let bar of [10,25,40,60,45,30,50,70,45,35,55,75,50,30,20,15,25,40,30,25]"
                         class="w-1.5 bg-amber-400/40 rounded-t"
                         [style.height.%]="bar"></div>
                  </div>

                  <button class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                    <div class="w-12 h-12 rounded-full bg-amber-500/90 flex items-center justify-center backdrop-blur-sm">
                      <i class="bi bi-play-fill text-xl text-white ml-1"></i>
                    </div>
                  </button>

                  <div class="absolute top-3 right-3 bg-black/60 backdrop-blur-sm text-xs text-slate-200 px-2 py-1 rounded-full">
                    {{ formatDuration(loop.duration) || 'Unknown' }}
                  </div>
                </div>

                <!-- Info -->
                <div class="space-y-2">
                  <div class="flex items-start justify-between gap-2">
                    <div class="min-w-0 flex-1">
                      <h4 class="font-semibold text-slate-100 truncate">{{ loop.filename || 'Untitled Loop' }}</h4>
                      <div class="mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs text-slate-400">
                        <span class="flex items-center gap-1">
                          <i class="bi bi-speedometer2 text-amber-400"></i>
                          <span class="text-slate-300 font-medium">{{ loop.bpm || '120' }} BPM</span>
                        </span>
                        <span class="flex items-center gap-1">
                          <i class="bi bi-music-note text-orange-400"></i>
                          <span class="text-slate-300 font-medium">{{ loop.key || 'C' }} {{ loop.scale || 'Major' }}</span>
                        </span>
                      </div>
                    </div>

                    <a [routerLink]="['/loop-detail/', loop._id]"
                       class="shrink-0 rounded-lg bg-slate-600/50 px-3 py-1.5 text-xs font-medium hover:bg-amber-600 transition-colors">
                      View
                    </a>
                  </div>

                  <div class="flex items-center justify-between text-xs text-slate-400 pt-2 border-t border-slate-600/30">
                    <div class="flex items-center gap-3">
                      <span class="flex items-center gap-1">
                        <i class="bi bi-download"></i>
                        <span class="text-slate-300 font-medium">{{ loop.downloads || 0 }}</span>
                      </span>
                      <span class="flex items-center gap-1">
                        <i class="bi bi-heart"></i>
                        <span class="text-slate-300 font-medium">{{ loop.likes || 0 }}</span>
                      </span>
                      <span class="flex items-center gap-1">
                        <i class="bi bi-chat"></i>
                        <span class="text-slate-300 font-medium">{{ loop.comments || 0 }}</span>
                      </span>
                    </div>
                    <span class="text-[11px]">{{ loop.uploadDate | date:'MMM dd, yyyy' }}</span>
                  </div>
                </div>

                <!-- Player -->
                <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                  <audio controls preload="none" class="w-full h-8 rounded-lg">
                    <source [src]="getLoopSource(loop)" type="audio/wav">
                  </audio>
                </div>
              </div>
            </div>

            <!-- Pagination -->
            <div *ngIf="userLoops.length > 6" class="flex justify-center mt-6">
              <div class="flex items-center gap-1 bg-slate-700/40 rounded-lg p-1 backdrop-blur-sm">
                <button class="w-8 h-8 flex items-center justify-center rounded-md hover:bg-slate-600/50 transition-colors">
                  <i class="bi bi-chevron-left"></i>
                </button>
                <button class="w-8 h-8 flex items-center justify-center rounded-md bg-amber-600 text-white">1</button>
                <button class="w-8 h-8 flex items-center justify-center rounded-md hover:bg-slate-600/50 transition-colors">2</button>
                <button class="w-8 h-8 flex items-center justify-center rounded-md hover:bg-slate-600/50 transition-colors">3</button>
                <button class="w-8 h-8 flex items-center justify-center rounded-md hover:bg-slate-600/50 transition-colors">
                  <i class="bi bi-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- OTHER TABS -->
        <div *ngIf="activeMainTab==='acapellas'" class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-6 text-center shadow-xl backdrop-blur-sm">
          <div class="text-slate-400 mb-3 text-5xl">
            <i class="bi bi-mic-fill"></i>
          </div>
          <h3 class="text-lg font-semibold text-amber-400 mb-1">Acapellas</h3>
          <p class="text-sm text-slate-300">No acapellas yet.</p>
        </div>

        <div *ngIf="activeMainTab==='tracks'" class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-6 text-center shadow-xl backdrop-blur-sm">
          <div class="text-slate-400 mb-3 text-5xl">
            <i class="bi bi-file-earmark-music-fill"></i>
          </div>
          <h3 class="text-lg font-semibold text-amber-400 mb-1">Tracks</h3>
          <p class="text-sm text-slate-300">No tracks yet.</p>
        </div>

        <div *ngIf="activeMainTab==='comments'" class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-6 shadow-xl backdrop-blur-sm">

          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">
                {{ userData?.username }}'s Comments
              </h3>
              <p class="text-sm text-slate-300 mt-1">Your activity on loops</p>
            </div>
            <div class="text-sm text-slate-400">
              Total: <span class="text-slate-200 font-semibold">{{ userComments.length }}</span>
            </div>
          </div>

          <!-- Loading -->
          <div *ngIf="commentsLoading" class="flex flex-col items-center justify-center py-12 text-slate-400">
            <i class="bi bi-arrow-repeat animate-spin text-4xl mb-3"></i>
            <p>Loading your comments...</p>
          </div>

          <!-- Empty -->
          <div *ngIf="!commentsLoading && userComments.length === 0"
              class="flex flex-col items-center justify-center py-12 text-center">
            <div class="w-20 h-20 rounded-full bg-slate-700/40 flex items-center justify-center mb-4 backdrop-blur-sm">
              <i class="bi bi-chat-dots text-4xl text-slate-400"></i>
            </div>
            <h4 class="text-lg font-semibold text-slate-200 mb-2">No comments yet</h4>
            <p class="text-sm text-slate-300 max-w-md">Start by commenting on some loops</p>
          </div>

          <!-- List -->
          <div *ngIf="!commentsLoading && userComments.length" class="space-y-4">
            <div *ngFor="let c of userComments"
                class="group rounded-xl border border-slate-600/30 bg-gradient-to-b from-slate-700/40 to-slate-800/40 p-4 hover:bg-slate-700/60 transition-all duration-300 backdrop-blur-sm">

              <div class="flex items-start justify-between gap-3">
                <div class="min-w-0">
                  <div class="text-sm text-slate-400 mb-1">
                    <i class="bi bi-clock me-1 text-amber-400"></i>
                    {{ c.createdAt | date:'MMM dd, yyyy • HH:mm' }}
                  </div>
                  <div class="text-slate-100 whitespace-pre-wrap">{{ c.text }}</div>

                  <div class="mt-2 flex flex-wrap gap-3 text-xs text-slate-400">
                    <span class="flex items-center gap-1">
                      <i class="bi bi-music-note-beamed text-orange-400"></i>
                      <span class="text-slate-300 font-medium truncate max-w-[220px]">{{ c?.loop?.filename || 'Loop' }}</span>
                    </span>
                    <span *ngIf="c?.loop?.bpm" class="flex items-center gap-1">
                      <i class="bi bi-speedometer2 text-amber-400"></i>
                      <span class="text-slate-300 font-medium">{{ c.loop.bpm }} BPM</span>
                    </span>
                    <span *ngIf="c?.loop?.key && c?.loop?.scale" class="flex items-center gap-1">
                      <i class="bi bi-music-note text-amber-400"></i>
                      <span class="text-slate-300 font-medium">{{ c.loop.key }} {{ c.loop.scale }}</span>
                    </span>
                  </div>
                </div>

                <a [routerLink]="['/loop-detail/', c?.loop?._id]"
                  class="shrink-0 rounded-lg bg-slate-600/50 px-3 py-1.5 text-xs font-medium hover:bg-amber-600 transition-colors">
                  View loop
                </a>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- RIGHT: STATS SIDEBAR -->
      <aside class="space-y-6">
        <!-- Loop Stats -->
        <div class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-5 shadow-xl backdrop-blur-sm">
          <h4 class="mb-4 text-base font-semibold text-amber-400"><i class="bi bi-bar-chart me-2"></i>Loop Stats</h4>

          <div class="grid grid-cols-2 gap-3">
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ statUploads }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Uploads</div>
            </div>
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ statDownloads }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Downloads</div>
            </div>
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ stat('downloaded') }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Downloaded</div>
            </div>
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ statCommentsOut }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Comments out</div>
            </div>
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ statLikesIn }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Favourites In</div>
            </div>
            <div class="rounded-xl border border-slate-600/30 bg-slate-700/40 p-4 text-center transition-all hover:bg-slate-700/60 backdrop-blur-sm">
              <div class="text-2xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">{{ stat('favouritesOut') }}</div>
              <div class="text-[12px] text-slate-400 mt-1">Favourites Out</div>
            </div>
          </div>
        </div>

        <!-- Quick info -->
        <div class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-5 shadow-xl backdrop-blur-sm">
          <h4 class="mb-3 text-sm font-semibold text-amber-400">Quick info</h4>
          <ul class="space-y-3 text-sm text-slate-300">
            <li class="flex items-center gap-3 p-2 rounded-lg bg-slate-700/40 backdrop-blur-sm">
              <div class="w-8 h-8 rounded-full bg-amber-600 flex items-center justify-center">
                <i class="bi bi-at text-sm"></i>
              </div>
              <span class="truncate">{{ userData?.username || '—' }}</span>
            </li>
            <li class="flex items-center gap-3 p-2 rounded-lg bg-slate-700/40 backdrop-blur-sm">
              <div class="w-8 h-8 rounded-full bg-orange-600 flex items-center justify-center">
                <i class="bi bi-geo-alt-fill text-sm"></i>
              </div>
              <span class="truncate">{{ userData?.city || '—' }}, {{ userData?.country || '—' }}</span>
            </li>
            <li class="flex items-center gap-3 p-2 rounded-lg bg-slate-700/40 backdrop-blur-sm">
              <div class="w-8 h-8 rounded-full bg-amber-600 flex items-center justify-center">
                <i class="bi bi-envelope-fill text-sm"></i>
              </div>
              <span class="truncate">{{ userData?.email || '—' }}</span>
            </li>
          </ul>
        </div>

        <!-- Action buttons -->
        <div class="rounded-2xl border border-slate-600/30 bg-gradient-to-b from-slate-800/80 to-slate-900/80 p-5 shadow-xl backdrop-blur-sm">
          <h4 class="mb-3 text-sm font-semibold text-amber-400">Actions</h4>
          <div class="space-y-2">
            <button (click)="startChatWithUser()" 
                    class="w-full flex items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-slate-700 to-slate-800 px-4 py-2.5 text-sm font-medium hover:from-amber-600 hover:to-orange-600 transition-all">
              <i class="bi bi-chat-dots-fill"></i> Send Message
            </button>
            <button *ngIf="!isCurrentUser" (click)="openProfileReportModal()" 
                    class="w-full flex items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-rose-700 to-red-700 px-4 py-2.5 text-sm font-medium hover:from-rose-600 hover:to-red-600 transition-all">
              <i class="bi bi-flag-fill"></i> Report Profile
            </button>
            <button *ngIf="isAdmin && !isCurrentUser" (click)="openBanModal()" 
                    class="w-full flex items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-red-700 to-red-800 px-4 py-2.5 text-sm font-medium hover:from-red-600 hover:to-red-700 transition-all">
              <i class="bi bi-shield-lock"></i> Admin Actions
            </button>
          </div>
        </div>
      </aside>
    </section>

    <!-- TOAST -->
    <div *ngIf="toast.text" 
         [class]="'fixed bottom-5 left-1/2 z-50 -translate-x-1/2 transform transition-all duration-300 ' + 
                  (toast.variant === 'success' ? 'bg-emerald-900/90 text-emerald-100 border-emerald-700' : 
                   toast.variant === 'error' ? 'bg-rose-900/90 text-rose-100 border-rose-700' : 
                   'bg-slate-900/90 text-slate-100 border-slate-700')"
         class="rounded-xl border px-4 py-3 shadow-lg">
      <div class="flex items-center gap-2">
        <i *ngIf="toast.variant === 'success'" class="bi bi-check-circle-fill text-emerald-400"></i>
        <i *ngIf="toast.variant === 'error'" class="bi bi-exclamation-circle-fill text-rose-400"></i>
        {{ toast.text }}
      </div>
    </div>
  </div>
</div>


  <!-- Profil jelentése modal -->
  <div *ngIf="isProfileReportOpen"
     class="fixed inset-0 z-50 grid place-items-center bg-black/70 p-4 backdrop-blur-sm"
     (click)="closeProfileReportModal($event)">
  <div class="w-full max-w-md rounded-2xl border border-slate-700/50 bg-gradient-to-b from-[#1a1d2b] to-[#1e2130] p-6 shadow-xl"
       (click)="$event.stopPropagation()">
      <div class="mb-4 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-100">
          {{ userData?.username || 'Felhasználó' }} jelentése
        </h3>
        <button (click)="isProfileReportOpen=false" class="rounded p-2 hover:bg-slate-800" title="Bezárás">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>

      <p class="mb-2 text-sm text-slate-300/90">Írd le röviden, miért szeretnéd jelenteni ezt a profilt.</p>

      <textarea [(ngModel)]="profileReportReason"
                rows="5" maxlength="1000"
                class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-rose-400/40"
                placeholder="Részletek..."></textarea>

      <div *ngIf="profileReportError" class="mt-2 text-sm text-rose-300">{{ profileReportError }}</div>
      <div *ngIf="profileReportSuccess" class="mt-2 text-sm text-emerald-300">{{ profileReportSuccess }}</div>

      <div class="mt-4 flex justify-end gap-2">
        <button (click)="isProfileReportOpen=false" class="rounded border border-slate-700 bg-slate-800 px-4 py-2 hover:bg-slate-700">Mégse</button>
        <button (click)="submitProfileReport()"
                [disabled]="isReportingProfile || !profileReportReason.trim()"
                class="rounded bg-gradient-to-r from-rose-600 to-red-600 px-4 py-2 text-white hover:opacity-95 disabled:opacity-50">
          {{ isReportingProfile ? 'Küldés...' : 'Jelentés elküldése' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Admin: Tiltás modal -->
 <div *ngIf="isBanModalOpen"
     class="fixed inset-0 z-[60] grid place-items-center bg-black/70 p-4 backdrop-blur-sm"
     (click)="closeBanModal($event)">
  <div class="w-full max-w-lg rounded-2xl border border-slate-700/50 bg-gradient-to-b from-[#1a1d2b] to-[#1e2130] p-6 shadow-xl"
       (click)="$event.stopPropagation()">
      <div class="mb-4 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-slate-100">
          Felhasználó tiltása – {{ userData?.username }}
        </h3>
        <button (click)="isBanModalOpen=false" class="rounded p-2 hover:bg-slate-800" title="Bezárás">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>

      <div class="grid grid-cols-1 gap-3 sm:grid-cols-3">
        <button type="button"
                (click)="banPreset='1d'"
                [class.ring-2]="banPreset==='1d'"
                [class.ring-rose-400]="banPreset==='1d'"
                class="w-full rounded-xl border border-slate-800 bg-slate-900 p-4 text-center hover:bg-slate-800">
          <div class="text-base font-semibold text-slate-100">1 nap</div>
          <div class="text-xs text-slate-400">Gyors ideiglenes tiltás</div>
        </button>

        <button type="button"
                (click)="banPreset='1m'"
                [class.ring-2]="banPreset==='1m'"
                [class.ring-rose-400]="banPreset==='1m'"
                class="w-full rounded-xl border border-slate-800 bg-slate-900 p-4 text-center hover:bg-slate-800">
          <div class="text-base font-semibold text-slate-100">1 hónap</div>
          <div class="text-xs text-slate-400">Hosszabb ideiglenes tiltás</div>
        </button>

        <button type="button"
                (click)="banPreset='permanent'"
                [class.ring-2]="banPreset==='permanent'"
                [class.ring-rose-400]="banPreset==='permanent'"
                class="w-full rounded-xl border border-slate-800 bg-slate-900 p-4 text-center hover:bg-slate-800">
          <div class="text-base font-semibold text-slate-100">Végleges</div>
          <div class="text-xs text-slate-400">Visszavonásig tiltva</div>
        </button>
      </div>

      <div class="mt-4">
        <label class="mb-1 block text-sm font-medium text-slate-200">Indoklás (opcionális)</label>
        <textarea [(ngModel)]="banReason"
                  rows="4" maxlength="500"
                  class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-rose-400/40"></textarea>
        <div class="mt-1 text-[11px] text-slate-400">{{ banReason.length || 0 }}/500</div>
      </div>

      <div *ngIf="userData?.bannedUntil && isStillBanned(userData?.bannedUntil)"
           class="mt-3 rounded-lg border border-rose-400/30 bg-rose-500/10 p-2 text-xs text-rose-300">
        <i class="bi bi-slash-circle-fill mr-1"></i>
        Jelenleg tiltva:
        {{ isPermanent(userData?.bannedUntil) ? 'véglegesen' : (userData?.bannedUntil | date:'yyyy.MM.dd. HH:mm') }}
      </div>

      <div class="mt-5 flex flex-wrap justify-between gap-2">
        <button type="button"
                (click)="isBanModalOpen=false"
                class="rounded-lg border border-slate-700 bg-slate-800 px-4 py-2 hover:bg-slate-700">
          Mégse
        </button>

        <div class="flex items-center gap-2">
          <button *ngIf="isStillBanned(userData?.bannedUntil)"
                  type="button"
                  (click)="unban()"
                  [disabled]="unbanning"
                  class="rounded-lg border border-slate-700 bg-slate-800 px-4 py-2 text-slate-200 hover:bg-slate-700 disabled:opacity-60">
            <span *ngIf="!unbanning"><i class="bi bi-unlock-fill mr-1"></i> Tiltás feloldása</span>
            <span *ngIf="unbanning"><i class="bi bi-arrow-repeat animate-spin mr-1"></i> Feloldás...</span>
          </button>

          <button type="button"
                  (click)="submitBan()"
                  [disabled]="banning"
                  class="rounded-lg bg-gradient-to-r from-rose-600 to-red-600 px-4 py-2 text-white hover:opacity-95 disabled:opacity-60">
            <span *ngIf="!banning"><i class="bi bi-shield-lock-fill mr-1"></i> Felhasználó tiltása</span>
            <span *ngIf="banning"><i class="bi bi-arrow-repeat animate-spin mr-1"></i> Mentés...</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div *ngIf="isSettingsOpen"
     class="fixed inset-0 z-[70] grid place-items-center bg-black/70 p-4 backdrop-blur-sm"
     (click)="closeSettings($event)">
  <div class="w-full max-w-3xl max-h-[85vh] flex flex-col overflow-hidden rounded-2xl border border-slate-700/50 bg-gradient-to-b from-[#1a1d2b] to-[#1e2130] shadow-xl"
     (click)="$event.stopPropagation()">
      <div class="flex items-center justify-between border-b border-slate-800 px-6 py-4">
        <h3 class="text-lg font-semibold !text-amber-400"><i class="bi bi-gear-wide-connected mr-2 "></i> Beállítások</h3>
        <button (click)="isSettingsOpen=false" class="rounded p-2 hover:bg-slate-800">
          <i class="bi bi-x-lg !text-amber-400"></i>
        </button>
      </div>

      <div class="grid grid-cols-12 flex-1 min-h-0 overflow-hidden">
        <!-- side nav -->
        <aside class="col-span-12 border-r border-slate-800 bg-slate-925/50 p-4 sm:col-span-4">
          <nav class="space-y-2">
            <button (click)="settingsTab='profile'"
                    class="w-full rounded-lg px-3 py-2 text-left text-sm"
                    [ngClass]="settingsTab==='profile' ? 'bg-slate-800 text-white' : 'text-slate-300 hover:bg-slate-800/60'">
              <i class="bi bi-person-badge mr-2"></i> Profil
            </button>
            <button (click)="settingsTab='account'"
                    class="w-full rounded-lg px-3 py-2 text-left text-sm"
                    [ngClass]="settingsTab==='account' ? 'bg-slate-800 text-white' : 'text-slate-300 hover:bg-slate-800/60'">
              <i class="bi bi-shield-lock mr-2"></i> Fiók
            </button>
          </nav>
        </aside>

        <!-- content -->
        <div class="col-span-12 p-6 sm:col-span-8 overflow-y-auto min-h-0 [webkit-overflow-scrolling:touch]">

          <!-- PROFILE TAB -->
          <div *ngIf="settingsTab==='profile'" class="space-y-6">
            <!-- Nicknév -->
            <div class="rounded-xl border border-slate-800 bg-slate-900 p-5">
              <h4 class="mb-3 text-sm font-semibold !text-amber-400">
                <i class="bi bi-at mr-1 !text-amber-400"></i> Nicknév módosítása
              </h4>
              <div class="flex flex-col gap-3 sm:flex-row">
                <input [(ngModel)]="usernameForm.newUsername"
                       class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-fuchsia-400/40"
                       placeholder="Új nicknév (3–20, csak betű/szám/_)"
                       maxlength="20" />
                <button (click)="changeUsername()"
                        [disabled]="savingUsername || !usernameForm.newUsername.trim()"
                        class="shrink-0 rounded-lg bg-fuchsia-600 px-4 py-2 text-white hover:bg-fuchsia-500 disabled:opacity-60">
                  {{ savingUsername ? 'Mentés…' : 'Mentés' }}
                </button>
              </div>
              <p *ngIf="msgUsername" class="mt-2 text-sm text-emerald-300">{{ msgUsername }}</p>
              <p *ngIf="errUsername" class="mt-2 text-sm text-rose-300">{{ errUsername }}</p>
            </div>

            <!-- Általános adatok -->
            <div class="rounded-xl border border-slate-800 bg-slate-900 p-5">
              <h4 class="mb-3 text-sm font-semibold !text-amber-400">
                <i class="bi bi-person-lines-fill mr-1 text-amber-400"></i> Általános adatok
              </h4>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <input [(ngModel)]="editForm.firstName" class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" placeholder="Keresztnév" />
                <input [(ngModel)]="editForm.lastName"  class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" placeholder="Vezetéknév" />
                <input [(ngModel)]="editForm.country"   class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" placeholder="Ország" />
                <input [(ngModel)]="editForm.city"      class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-400/40" placeholder="Város" />
              </div>
              <div class="mt-4 flex gap-2">
                <button (click)="saveGeneral()" [disabled]="saving.general"
                        class="rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-500 disabled:opacity-60">
                  {{ saving.general ? 'Mentés…' : 'Mentés' }}
                </button>
                <button (click)="resetGeneral()" [disabled]="saving.general"
                        class="rounded-lg border border-slate-700 bg-slate-800 px-4 py-2 text-white hover:bg-slate-700 disabled:opacity-60">
                  Mégse
                </button>
              </div>
              <p *ngIf="msg.general" class="mt-2 text-sm text-emerald-300">{{ msg.general }}</p>
              <p *ngIf="err.general" class="mt-2 text-sm text-rose-300">{{ err.general }}</p>
              
            </div>
            <!-- Social links -->
<div class="rounded-xl border border-slate-800 bg-slate-900 p-5">
  <h4 class="mb-3 text-sm font-semibold !text-amber-400">
    <i class="bi bi-link-45deg mr-1 text-amber-400"></i> Közösségi elérhetőségek
  </h4>

  <div class="grid grid-cols-1 gap-3">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      <input [(ngModel)]="socials.facebook"   placeholder="Facebook URL"   class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.instagram"  placeholder="Instagram URL"  class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.youtube"    placeholder="YouTube URL"    class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.soundcloud" placeholder="SoundCloud URL" class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.spotify"    placeholder="Spotify URL"    class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.tiktok"     placeholder="TikTok URL"     class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.x"          placeholder="X / Twitter URL" class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.website"    placeholder="Saját weboldal" class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
      <input [(ngModel)]="socials.email"      placeholder="E-mail (vagy mailto:...)" class="rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100" />
    </div>

    <div class="mt-3 flex gap-2">
      <button (click)="saveSocials()" [disabled]="savingSocials"
              class="rounded-lg bg-gradient-to-r from-amber-600 to-orange-600 px-4 py-2 text-sm font-medium hover:from-amber-500 hover:to-orange-500 disabled:opacity-60">
        {{ savingSocials ? 'Mentés…' : 'Linkek mentése' }}
      </button>
    </div>

    <p *ngIf="msgSocials" class="text-sm text-emerald-300">{{ msgSocials }}</p>
    <p *ngIf="errSocials" class="text-sm text-rose-300">{{ errSocials }}</p>
  </div>
</div>

          </div>

          <!-- ACCOUNT TAB -->
          <div *ngIf="settingsTab==='account'" class="space-y-6">
            <!-- Email -->
            <div class="rounded-xl border border-slate-800 bg-slate-900 p-5">
              <h4 class="mb-3 text-sm font-semibold !text-amber-300">
                <i class="bi bi-envelope-at mr-1 text-amber-300"></i> E-mail csere
              </h4>

              <div *ngIf="isGoogleAccount; else localEmailBlock"
                   class="rounded-lg border border-amber-400/30 bg-amber-500/10 p-3 text-sm text-amber-200">
                <i class="bi bi-google mr-1"></i>
                Google-fiókos bejelentkezésnél az e-mail a Google-nál kezelhető. Itt nem módosítható és nem kérünk jelszót.
              </div>

              <ng-template #localEmailBlock>
                <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                  <input [(ngModel)]="emailForm.newEmail" type="email"
                         class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-amber-400/40"
                         placeholder="Új e-mail" />
                  <input [(ngModel)]="emailForm.password" type="password"
                         class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-amber-400/40"
                         placeholder="Jelszó megerősítéshez" />
                </div>
                <div class="mt-4">
                  <button (click)="changeEmail()" [disabled]="saving.email"
                          class="rounded-lg bg-gradient-to-r from-amber-500 to-rose-500 px-4 py-2 text-white hover:opacity-95 disabled:opacity-60">
     












                                        {{ saving.email ? 'Küldés…' : 'E-mail módosítása' }}
                  </button>
                </div>

                <p *ngIf="msg.email" class="mt-2 text-sm text-emerald-300">{{ msg.email }}</p>
                <p *ngIf="err.email" class="mt-2 text-sm text-rose-300">{{ err.email }}</p>
              </ng-template>
            </div>

            <!-- Jelszó csere -->
            <div class="rounded-xl border border-slate-800 bg-slate-900 p-5">
              <h4 class="mb-3 text-sm font-semibold !text-emerald-300">
                <i class="bi bi-shield-lock-fill mr-1 text-emerald-300"></i> Jelszó csere
              </h4>

              <!-- Google fióknál nincs jelszó -->
              <div *ngIf="isGoogleAccount; else localPassBlock"
                   class="rounded-lg border border-emerald-400/30 bg-emerald-500/10 p-3 text-sm text-emerald-200">
                <i class="bi bi-google mr-1"></i>
                Google-fiókkal vagy bejelentkezve — itt nem kérünk és nem is állítunk jelszót.
              </div>

              <ng-template #localPassBlock>
                <div class="grid grid-cols-1 gap-4 sm:grid-cols-3">
                  <input [(ngModel)]="passForm.currentPassword" [disabled]="saving.pass" type="password"
                         class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-emerald-400/40"
                         placeholder="Jelenlegi jelszó" aria-label="Jelenlegi jelszó" />
                  <input [(ngModel)]="passForm.newPassword" [disabled]="saving.pass" type="password"
                         class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-emerald-400/40"
                         placeholder="Új jelszó" aria-label="Új jelszó" />
                  <input [(ngModel)]="passForm.confirmPassword" [disabled]="saving.pass" type="password"
                         class="w-full rounded-lg border border-slate-700 bg-slate-800 p-3 text-slate-100 focus:outline-none focus:ring-2 focus:ring-emerald-400/40"
                         placeholder="Új jelszó mégegyszer" aria-label="Új jelszó mégegyszer" />
                </div>

                <div class="mt-4">
                  <button (click)="changePassword()" [disabled]="saving.pass"
                          class="rounded-lg bg-gradient-to-r from-emerald-500 to-cyan-500 px-4 py-2 text-white hover:opacity-95 disabled:opacity-60">
                    {{ saving.pass ? 'Módosítás…' : 'Jelszó módosítása' }}
                  </button>
                </div>

                <p *ngIf="msg.pass" class="mt-2 text-sm text-emerald-300">{{ msg.pass }}</p>
                <p *ngIf="err.pass" class="mt-2 text-sm text-rose-300">{{ err.pass }}</p>
              </ng-template>
            </div>
          </div>
          <!-- /ACCOUNT TAB vége -->
        </div>
      </div>
      <!-- /content -->
    </div>
  </div>
<!-- </div> -->
<!-- /SETTINGS MODAL vége -->

